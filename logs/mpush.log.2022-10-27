2022-10-27 09:55:40.329 - [mp-conn-work-3-5] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@5180dc43
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:55:49.917 - [mp-conn-work-3-6] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@cf89589
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:55:51.446 - [mp-conn-work-3-6] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@1ddef43b
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:55:52.976 - [mp-conn-work-3-6] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@4a88675e
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:55:53.556 - [mp-conn-work-3-6] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@26f12d42
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:55:54.028 - [mp-conn-work-3-6] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@72ea651b
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:55:54.274 - [mp-conn-work-3-6] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@27c7030f
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:55:54.488 - [mp-conn-work-3-6] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@2be510cb
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:55:54.692 - [mp-conn-work-3-6] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@48218364
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:55:54.913 - [mp-conn-work-3-6] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@733d73c9
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:55:55.119 - [mp-conn-work-3-6] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@5bec94c5
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:56:12.122 - [mp-conn-work-3-7] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@498cc396
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 09:56:21.645 - [mp-conn-work-3-8] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@64a02c4
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:00:41.638 - [mp-conn-work-3-3] ERROR - com.mpush.tools.Jsons - Jsons.fromJson ex, json=1111, clazz=class com.mpush.api.protocol.JsonPacket
com.alibaba.fastjson.JSONException: syntax error, expect {, actual int, pos 0, fastjson-version 1.2.47
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:451)
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.parseRest(JavaBeanDeserializer.java:1283)
	at com.alibaba.fastjson.parser.deserializer.FastjsonASMDeserializer_1_JsonPacket.deserialze(Unknown Source)
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:267)
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseObject(DefaultJSONParser.java:661)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:365)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:269)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:488)
	at com.mpush.tools.Jsons.fromJson(Jsons.java:53)
	at com.mpush.netty.codec.PacketDecoder.decodeFrame(PacketDecoder.java:105)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:40)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:00:41.639 - [mp-conn-work-3-3] ERROR - c.m.c.s.WebSocketChannelHandler - caught an ex, channel=[id: 0xc65db4f6, L:/10.200.5.34:8888 - R:/10.200.5.49:64613], conn=[channel=[id: 0xc65db4f6, L:/10.200.5.34:8888 - R:/10.200.5.49:64613], context=, status=1, lastReadTime=1666836032022, lastWriteTime=0]
java.lang.NullPointerException: null
	at com.mpush.common.MessageDispatcher.onReceive(MessageDispatcher.java:82)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:42)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:01:00.872 - [mp-conn-work-3-4] ERROR - com.mpush.tools.Jsons - Jsons.fromJson ex, json=1111, clazz=class com.mpush.api.protocol.JsonPacket
com.alibaba.fastjson.JSONException: syntax error, expect {, actual int, pos 0, fastjson-version 1.2.47
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:451)
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.parseRest(JavaBeanDeserializer.java:1283)
	at com.alibaba.fastjson.parser.deserializer.FastjsonASMDeserializer_1_JsonPacket.deserialze(Unknown Source)
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:267)
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseObject(DefaultJSONParser.java:661)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:365)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:269)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:488)
	at com.mpush.tools.Jsons.fromJson(Jsons.java:53)
	at com.mpush.netty.codec.PacketDecoder.decodeFrame(PacketDecoder.java:105)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:40)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:01:00.873 - [mp-conn-work-3-4] ERROR - c.m.c.s.WebSocketChannelHandler - caught an ex, channel=[id: 0x7cb0482d, L:/10.200.5.34:8888 - R:/10.200.5.49:53119], conn=[channel=[id: 0x7cb0482d, L:/10.200.5.34:8888 - R:/10.200.5.49:53119], context=, status=1, lastReadTime=1666836046646, lastWriteTime=0]
java.lang.NullPointerException: null
	at com.mpush.common.MessageDispatcher.onReceive(MessageDispatcher.java:82)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:42)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:29:56.957 - [mp-conn-work-3-2] ERROR - com.mpush.tools.Jsons - Jsons.fromJson ex, json=11111, clazz=class com.mpush.api.protocol.JsonPacket
com.alibaba.fastjson.JSONException: syntax error, expect {, actual int, pos 0, fastjson-version 1.2.47
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:451)
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.parseRest(JavaBeanDeserializer.java:1283)
	at com.alibaba.fastjson.parser.deserializer.FastjsonASMDeserializer_1_JsonPacket.deserialze(Unknown Source)
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:267)
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseObject(DefaultJSONParser.java:661)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:365)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:269)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:488)
	at com.mpush.tools.Jsons.fromJson(Jsons.java:53)
	at com.mpush.netty.codec.PacketDecoder.decodeFrame(PacketDecoder.java:105)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:40)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:29:56.971 - [mp-conn-work-3-2] ERROR - c.m.c.s.WebSocketChannelHandler - caught an ex, channel=[id: 0x38621675, L:/10.200.5.34:8888 - R:/10.200.5.49:64166], conn=[channel=[id: 0x38621675, L:/10.200.5.34:8888 - R:/10.200.5.49:64166], context=, status=1, lastReadTime=1666837788920, lastWriteTime=0]
java.lang.NullPointerException: null
	at com.mpush.common.MessageDispatcher.onReceive(MessageDispatcher.java:82)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:42)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:31:28.151 - [mp-conn-work-3-4] ERROR - com.mpush.tools.Jsons - Jsons.fromJson ex, json=[object Object], clazz=class com.mpush.api.protocol.JsonPacket
com.alibaba.fastjson.JSONException: syntax error, expect {, actual [, pos 0, fastjson-version 1.2.47
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:451)
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.parseRest(JavaBeanDeserializer.java:1283)
	at com.alibaba.fastjson.parser.deserializer.FastjsonASMDeserializer_1_JsonPacket.deserialze(Unknown Source)
	at com.alibaba.fastjson.parser.deserializer.JavaBeanDeserializer.deserialze(JavaBeanDeserializer.java:267)
	at com.alibaba.fastjson.parser.DefaultJSONParser.parseObject(DefaultJSONParser.java:661)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:365)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:269)
	at com.alibaba.fastjson.JSON.parseObject(JSON.java:488)
	at com.mpush.tools.Jsons.fromJson(Jsons.java:53)
	at com.mpush.netty.codec.PacketDecoder.decodeFrame(PacketDecoder.java:105)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:40)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:31:28.152 - [mp-conn-work-3-4] ERROR - c.m.c.s.WebSocketChannelHandler - caught an ex, channel=[id: 0x8d463a8a, L:/10.200.5.34:8888 - R:/10.200.5.49:55184], conn=[channel=[id: 0x8d463a8a, L:/10.200.5.34:8888 - R:/10.200.5.49:55184], context=, status=1, lastReadTime=1666837879033, lastWriteTime=0]
java.lang.NullPointerException: null
	at com.mpush.common.MessageDispatcher.onReceive(MessageDispatcher.java:82)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:42)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:44:31.997 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 4132ms for sessionid 0x1006ae76e9c008a
2022-10-27 10:46:53.112 - [main-EventThread] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 139980 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:46:55.012 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 141989ms for sessionid 0x1006ae76e9c008a
2022-10-27 10:47:10.275 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 6073ms for sessionid 0x1006ae76e9c008b
2022-10-27 10:47:42.564 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 28576 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:47:42.565 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 28577ms for sessionid 0x1006ae76e9c008b
2022-10-27 10:47:52.920 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 5465ms for sessionid 0x1006ae76e9c008c
2022-10-27 10:47:53.403 - [Curator-Framework-0-EventThread] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (12000). Pinning to 5000
2022-10-27 10:47:53.403 - [Curator-Framework-0-EventThread] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 10:47:56.609 - [Curator-Framework-0-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 10:47:56.611 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c008c has expired
2022-10-27 10:47:59.457 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:857)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:47:59.457 - [mp-conn-work-3-2] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@7aa0832b
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:47:59.458 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background retry gave up
org.apache.curator.CuratorConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:838)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:47:59.459 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 10:50:12.016 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 5347ms for sessionid 0x1006ae76e9c008d
2022-10-27 10:50:14.968 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c008d has expired
2022-10-27 10:50:14.968 - [Curator-Framework-0-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 10:50:18.816 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 3807ms for sessionid 0x1006ae76e9c008e
2022-10-27 10:50:54.851 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 30251ms for sessionid 0x1006ae76e9c008e
2022-10-27 10:50:58.074 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c008e has expired
2022-10-27 10:50:58.074 - [Curator-Framework-0-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 10:51:15.044 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 15348ms for sessionid 0x1006ae76e9c008f
2022-10-27 10:51:35.215 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 8960 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:51:36.400 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 10146ms for sessionid 0x1006ae76e9c008f
2022-10-27 10:51:36.799 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (6000). Pinning to 5000
2022-10-27 10:52:16.306 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 37943ms for sessionid 0x1006ae76e9c0090
2022-10-27 10:52:17.392 - [Curator-Framework-0-EventThread] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (18000). Pinning to 5000
2022-10-27 10:52:22.618 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 5231ms for sessionid 0x1006ae76e9c0090
2022-10-27 10:52:22.659 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (21000). Pinning to 5000
2022-10-27 10:52:22.659 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 5267 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:52:23.640 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:857)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:52:23.641 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background retry gave up
org.apache.curator.CuratorConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:838)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:52:29.699 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 5566ms for sessionid 0x1006ae76e9c0091
2022-10-27 10:52:30.754 - [Curator-ConnectionStateManager-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 10:52:30.754 - [Curator-Framework-0-EventThread] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.processBackgroundOperation(CuratorFrameworkImpl.java:516)
	at org.apache.curator.framework.imps.BackgroundSyncImpl$1.processResult(BackgroundSyncImpl.java:53)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:634)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:505)
2022-10-27 10:52:37.912 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 7156 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:53:01.374 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 30649ms for sessionid 0x1006ae76e9c0091
2022-10-27 10:53:01.480 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 23568 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:53:01.594 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (21000). Pinning to 5000
2022-10-27 10:53:39.302 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 4244ms for sessionid 0x1006ae76e9c0092
2022-10-27 10:53:44.977 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c0092 has expired
2022-10-27 10:53:44.984 - [Curator-Framework-0-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 10:53:50.994 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 3445ms for sessionid 0x1006ae76e9c0093
2022-10-27 10:53:50.999 - [mp-conn-work-3-3] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@6a54f598
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:54:03.121 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 3982ms for sessionid 0x1006ae76e9c0093
2022-10-27 10:54:16.950 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c0093 has expired
2022-10-27 10:54:16.951 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 10245 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:54:16.969 - [Curator-Framework-0-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 10:54:22.770 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 5747 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:54:36.017 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 6943ms for sessionid 0x1006ae76e9c0094
2022-10-27 10:54:38.743 - [Curator-Framework-0-EventThread] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (6000). Pinning to 5000
2022-10-27 10:54:43.529 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c0094 has expired
2022-10-27 10:54:43.529 - [Curator-Framework-0-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 10:54:45.398 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:857)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:54:45.398 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background retry gave up
org.apache.curator.CuratorConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:838)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:54:52.816 - [Curator-ConnectionStateManager-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 9286 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:54:57.536 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (15000). Pinning to 5000
2022-10-27 10:54:57.536 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 10:55:27.995 - [Curator-ConnectionStateManager-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 29607ms for sessionid 0x1006ae76e9c0096
2022-10-27 10:55:29.402 - [Curator-ConnectionStateManager-0-EventThread] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.processBackgroundOperation(CuratorFrameworkImpl.java:516)
	at org.apache.curator.framework.imps.BackgroundSyncImpl$1.processResult(BackgroundSyncImpl.java:53)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:634)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:505)
2022-10-27 10:55:29.403 - [Curator-ConnectionStateManager-0-EventThread] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 10:55:35.113 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 5710 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:55:40.293 - [Curator-ConnectionStateManager-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 10899ms for sessionid 0x1006ae76e9c0096
2022-10-27 10:55:43.044 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:857)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:55:43.044 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background retry gave up
org.apache.curator.CuratorConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:838)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 10:55:43.051 - [Curator-ConnectionStateManager-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 7928 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 10:55:44.136 - [mp-conn-work-3-8] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@1b80e121
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:04:05.269 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 5422ms for sessionid 0x1006ae76e9c0099
2022-10-27 11:04:07.653 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c0099 has expired
2022-10-27 11:04:07.653 - [main-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 11:04:28.960 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 6479ms for sessionid 0x1006ae76e9c009a
2022-10-27 11:04:34.267 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c009a has expired
2022-10-27 11:04:34.274 - [main-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 11:04:44.075 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 5325ms for sessionid 0x1006ae76e9c009b
2022-10-27 11:04:44.086 - [mp-conn-work-3-1] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@4f56794b
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:04:45.285 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c009b has expired
2022-10-27 11:04:45.285 - [main-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 11:06:58.006 - [mp-conn-work-3-7] ERROR - com.mpush.common.MessageDispatcher - dispatch message ex, packet=JsonPacket{cmd=19, cc=0, flags=16, sessionId=27, lrc=0, body={"fromUserId":25,"toUserType":"1","fromUserType":"2","userId":"36","content":"222","token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJhdXRoMCIsImV4cCI6MTY2NzM3MjM5OCwiaWF0IjoxNjY2NzY3NTk4LCJ1c2VySWQiOiIyNSJ9.KZ6CzdOI5ot6gInPLqPlmP2CVqy5QYZ0ROAEjYqhuWU"}}, connect=[channel=[id: 0xc4e86d22, L:/10.200.5.34:8888 - R:/10.200.5.49:56955], context=, status=1, lastReadTime=1666840007817, lastWriteTime=0], body=null
java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.String
	at com.mpush.core.handler.UserChatHandler.decode(UserChatHandler.java:67)
	at com.mpush.core.handler.UserChatHandler.decode(UserChatHandler.java:47)
	at com.mpush.common.handler.BaseMessageHandler.handle(BaseMessageHandler.java:44)
	at com.mpush.common.MessageDispatcher.onReceive(MessageDispatcher.java:86)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:42)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:07:32.958 - [mp-conn-work-3-8] ERROR - com.mpush.common.MessageDispatcher - dispatch message ex, packet=JsonPacket{cmd=19, cc=0, flags=16, sessionId=27, lrc=0, body={"fromUserId":25,"toUserType":"1","fromUserType":"2","userId":"36","content":"222","token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJhdXRoMCIsImV4cCI6MTY2NzM3MjM5OCwiaWF0IjoxNjY2NzY3NTk4LCJ1c2VySWQiOiIyNSJ9.KZ6CzdOI5ot6gInPLqPlmP2CVqy5QYZ0ROAEjYqhuWU"}}, connect=[channel=[id: 0x506dcaf1, L:/10.200.5.34:8888 - R:/10.200.5.49:56391], context=, status=1, lastReadTime=1666840049672, lastWriteTime=0], body=null
java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.String
	at com.mpush.core.handler.UserChatHandler.decode(UserChatHandler.java:67)
	at com.mpush.core.handler.UserChatHandler.decode(UserChatHandler.java:47)
	at com.mpush.common.handler.BaseMessageHandler.handle(BaseMessageHandler.java:44)
	at com.mpush.common.MessageDispatcher.onReceive(MessageDispatcher.java:86)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:42)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:08:04.793 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 5043ms for sessionid 0x1006ae76e9c009c
2022-10-27 11:08:17.305 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 11522 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:08:18.591 - [main-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 12808ms for sessionid 0x1006ae76e9c009c
2022-10-27 11:08:27.653 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 5941ms for sessionid 0x0
2022-10-27 11:08:27.654 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 10342 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:08:29.366 - [mp-conn-work-3-3] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@75587417
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:08:56.770 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 18386ms for sessionid 0x1006ae76e9c009d
2022-10-27 11:09:11.901 - [Curator-Framework-0-EventThread] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (21000). Pinning to 5000
2022-10-27 11:09:13.959 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 8598ms for sessionid 0x1006ae76e9c009d
2022-10-27 11:09:20.629 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 8725 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:09:37.640 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (6000). Pinning to 5000
2022-10-27 11:09:37.641 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 17012 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:09:48.386 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 10744 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:10:17.163 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 28777 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:10:18.776 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 11:10:18.776 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 11:10:18.776 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 11:10:18.776 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (6000). Pinning to 5000
2022-10-27 11:10:18.776 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 11:10:18.777 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (6000). Pinning to 5000
2022-10-27 11:10:18.777 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (6000). Pinning to 5000
2022-10-27 11:10:18.777 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (6000). Pinning to 5000
2022-10-27 11:10:18.777 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 11:10:18.777 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 11:10:18.778 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (21000). Pinning to 5000
2022-10-27 11:10:18.779 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:857)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:10:18.782 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background retry gave up
org.apache.curator.CuratorConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:838)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:10:18.782 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (18000). Pinning to 5000
2022-10-27 11:10:18.782 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (6000). Pinning to 5000
2022-10-27 11:11:42.228 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 3427ms for sessionid 0x1006ae76e9c009e
2022-10-27 11:11:45.461 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c009e has expired
2022-10-27 11:11:45.465 - [Curator-Framework-0-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 11:12:12.454 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 9302ms for sessionid 0x1006ae76e9c009f
2022-10-27 11:12:17.531 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c009f has expired
2022-10-27 11:12:17.533 - [Curator-Framework-0-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 11:12:36.189 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 18643ms for sessionid 0x1006ae76e9c00a0
2022-10-27 11:12:45.562 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 8265 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:12:46.614 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 9321ms for sessionid 0x1006ae76e9c00a0
2022-10-27 11:12:47.871 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 11:12:51.322 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 5740 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:13:41.667 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 44201ms for sessionid 0x1006ae76e9c00a2
2022-10-27 11:13:43.351 - [Curator-Framework-0-EventThread] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.processBackgroundOperation(CuratorFrameworkImpl.java:516)
	at org.apache.curator.framework.imps.BackgroundSyncImpl$1.processResult(BackgroundSyncImpl.java:53)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:634)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:505)
2022-10-27 11:13:43.351 - [Curator-Framework-0-EventThread] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (21000). Pinning to 5000
2022-10-27 11:13:48.911 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 5561ms for sessionid 0x1006ae76e9c00a2
2022-10-27 11:13:48.912 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 5561 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:14:02.117 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 13205 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:14:05.082 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:857)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:14:05.085 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background retry gave up
org.apache.curator.CuratorConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:838)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:14:15.048 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 9919ms for sessionid 0x1006ae76e9c00a3
2022-10-27 11:14:16.572 - [Curator-Framework-0-EventThread] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (6000). Pinning to 5000
2022-10-27 11:14:26.338 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 9767ms for sessionid 0x1006ae76e9c00a3
2022-10-27 11:14:26.342 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 9770 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:14:26.460 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (12000). Pinning to 5000
2022-10-27 11:14:26.460 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (9000). Pinning to 5000
2022-10-27 11:14:26.461 - [Curator-Framework-0] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (21000). Pinning to 5000
2022-10-27 11:14:35.248 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 5775ms for sessionid 0x1006ae76e9c00a4
2022-10-27 11:14:42.920 - [Curator-Framework-0-EventThread] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.processBackgroundOperation(CuratorFrameworkImpl.java:516)
	at org.apache.curator.framework.imps.BackgroundSyncImpl$1.processResult(BackgroundSyncImpl.java:53)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:634)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:505)
2022-10-27 11:14:42.920 - [Curator-Framework-0-EventThread] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.processBackgroundOperation(CuratorFrameworkImpl.java:516)
	at org.apache.curator.framework.imps.BackgroundSyncImpl$1.processResult(BackgroundSyncImpl.java:53)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:634)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:505)
2022-10-27 11:14:42.921 - [Curator-Framework-0-EventThread] WARN  - o.a.c.retry.ExponentialBackoffRetry - Sleep extension too large (6000). Pinning to 5000
2022-10-27 11:14:44.613 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Client session timed out, have not heard from server in 8668ms for sessionid 0x1006ae76e9c00a4
2022-10-27 11:14:47.197 - [Curator-Framework-0-EventThread] WARN  - org.apache.curator.ConnectionState - Session expired event received
2022-10-27 11:14:47.197 - [Curator-Framework-0-SendThread(10.200.200.145:2181)] WARN  - org.apache.zookeeper.ClientCnxn - Unable to reconnect to ZooKeeper service, session 0x1006ae76e9c00a4 has expired
2022-10-27 11:19:52.106 - [Curator-Framework-0] WARN  - org.apache.curator.ConnectionState - Connection attempt unsuccessful after 304909 (greater than max timeout of 5000). Resetting connection and trying again with a new connection.
2022-10-27 11:19:52.216 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background operation retry gave up
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.checkBackgroundRetry(CuratorFrameworkImpl.java:728)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:857)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:19:52.216 - [Curator-Framework-0] ERROR - o.a.c.f.imps.CuratorFrameworkImpl - Background retry gave up
org.apache.curator.CuratorConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.performBackgroundOperation(CuratorFrameworkImpl.java:838)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.backgroundOperationsLoop(CuratorFrameworkImpl.java:809)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl.access$300(CuratorFrameworkImpl.java:64)
	at org.apache.curator.framework.imps.CuratorFrameworkImpl$4.call(CuratorFrameworkImpl.java:267)
	at java.util.concurrent.FutureTask.run$$$capture(FutureTask.java:266)
	at java.util.concurrent.FutureTask.run(FutureTask.java)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:21:20.376 - [mp-conn-work-3-4] WARN  - i.n.util.concurrent.DefaultPromise - An exception was thrown by com.mpush.core.push.SingleUserPushTask.operationComplete()
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onTimeout(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkTimeout(SingleUserPushTask.java:99)
	at com.mpush.core.push.SingleUserPushTask.operationComplete(SingleUserPushTask.java:206)
	at com.mpush.core.push.SingleUserPushTask.operationComplete(SingleUserPushTask.java:44)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:511)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:504)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:483)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:424)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:103)
	at io.netty.util.internal.PromiseNotificationUtil.trySuccess(PromiseNotificationUtil.java:48)
	at io.netty.channel.ChannelOutboundBuffer.safeSuccess(ChannelOutboundBuffer.java:696)
	at io.netty.channel.ChannelOutboundBuffer.remove(ChannelOutboundBuffer.java:258)
	at io.netty.channel.ChannelOutboundBuffer.removeBytes(ChannelOutboundBuffer.java:338)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:409)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:934)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:360)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:901)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1396)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:749)
	at io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:115)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:749)
	at io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:115)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.access$1500(AbstractChannelHandlerContext.java:38)
	at io.netty.channel.AbstractChannelHandlerContext$WriteAndFlushTask.write(AbstractChannelHandlerContext.java:1129)
	at io.netty.channel.AbstractChannelHandlerContext$AbstractWriteTask.run(AbstractChannelHandlerContext.java:1070)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:25:04.679 - [mp-conn-work-3-5] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@51fa8eea
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:26:56.033 - [mp-conn-work-3-7] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@2582298a
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:27:06.307 - [mp-conn-work-3-7] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@67dba980
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:28:15.578 - [mp-conn-work-3-1] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@4813fd35
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:29:03.217 - [mp-conn-work-3-2] WARN  - i.n.util.concurrent.DefaultPromise - An exception was thrown by com.mpush.core.push.SingleUserPushTask.operationComplete()
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onSuccess(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.operationComplete(SingleUserPushTask.java:213)
	at com.mpush.core.push.SingleUserPushTask.operationComplete(SingleUserPushTask.java:44)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:511)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:504)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:483)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:424)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:103)
	at io.netty.util.internal.PromiseNotificationUtil.trySuccess(PromiseNotificationUtil.java:48)
	at io.netty.channel.ChannelOutboundBuffer.safeSuccess(ChannelOutboundBuffer.java:696)
	at io.netty.channel.ChannelOutboundBuffer.remove(ChannelOutboundBuffer.java:258)
	at io.netty.channel.ChannelOutboundBuffer.removeBytes(ChannelOutboundBuffer.java:338)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:409)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:934)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:360)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:901)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1396)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:749)
	at io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:115)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:749)
	at io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:115)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.access$1500(AbstractChannelHandlerContext.java:38)
	at io.netty.channel.AbstractChannelHandlerContext$WriteAndFlushTask.write(AbstractChannelHandlerContext.java:1129)
	at io.netty.channel.AbstractChannelHandlerContext$AbstractWriteTask.run(AbstractChannelHandlerContext.java:1070)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:29:36.043 - [mp-conn-work-3-2] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@3dd8b421
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:29:44.068 - [mp-conn-work-3-3] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@569833dc
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:29:52.242 - [mp-conn-work-3-1] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@144a7252
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:46:42.089 - [mp-conn-work-3-8] WARN  - i.n.util.concurrent.DefaultPromise - An exception was thrown by com.mpush.core.push.SingleUserPushTask.operationComplete()
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onSuccess(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.operationComplete(SingleUserPushTask.java:213)
	at com.mpush.core.push.SingleUserPushTask.operationComplete(SingleUserPushTask.java:44)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:511)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:504)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:483)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:424)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:103)
	at io.netty.util.internal.PromiseNotificationUtil.trySuccess(PromiseNotificationUtil.java:48)
	at io.netty.channel.ChannelOutboundBuffer.safeSuccess(ChannelOutboundBuffer.java:696)
	at io.netty.channel.ChannelOutboundBuffer.remove(ChannelOutboundBuffer.java:258)
	at io.netty.channel.ChannelOutboundBuffer.removeBytes(ChannelOutboundBuffer.java:338)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:409)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:934)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:360)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:901)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1396)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:749)
	at io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:115)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:749)
	at io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:115)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.access$1500(AbstractChannelHandlerContext.java:38)
	at io.netty.channel.AbstractChannelHandlerContext$WriteAndFlushTask.write(AbstractChannelHandlerContext.java:1129)
	at io.netty.channel.AbstractChannelHandlerContext$AbstractWriteTask.run(AbstractChannelHandlerContext.java:1070)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:47:02.716 - [mp-conn-work-3-1] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@18683254
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:48:11.755 - [mp-conn-work-3-4] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@1d76abc1
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 11:49:08.270 - [mp-conn-work-3-5] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@1dacfae0
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 15:48:37.882 - [mp-conn-work-3-4] WARN  - i.n.util.concurrent.DefaultPromise - An exception was thrown by com.mpush.core.push.SingleUserPushTask.operationComplete()
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onTimeout(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkTimeout(SingleUserPushTask.java:99)
	at com.mpush.core.push.SingleUserPushTask.operationComplete(SingleUserPushTask.java:206)
	at com.mpush.core.push.SingleUserPushTask.operationComplete(SingleUserPushTask.java:44)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:511)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:504)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:483)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:424)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:103)
	at io.netty.util.internal.PromiseNotificationUtil.trySuccess(PromiseNotificationUtil.java:48)
	at io.netty.channel.ChannelOutboundBuffer.safeSuccess(ChannelOutboundBuffer.java:696)
	at io.netty.channel.ChannelOutboundBuffer.remove(ChannelOutboundBuffer.java:258)
	at io.netty.channel.ChannelOutboundBuffer.removeBytes(ChannelOutboundBuffer.java:338)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:409)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:934)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.flush0(AbstractNioChannel.java:360)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush(AbstractChannel.java:901)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.flush(DefaultChannelPipeline.java:1396)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:749)
	at io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:115)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.flush(AbstractChannelHandlerContext.java:749)
	at io.netty.channel.ChannelOutboundHandlerAdapter.flush(ChannelOutboundHandlerAdapter.java:115)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush0(AbstractChannelHandlerContext.java:776)
	at io.netty.channel.AbstractChannelHandlerContext.invokeFlush(AbstractChannelHandlerContext.java:768)
	at io.netty.channel.AbstractChannelHandlerContext.access$1500(AbstractChannelHandlerContext.java:38)
	at io.netty.channel.AbstractChannelHandlerContext$WriteAndFlushTask.write(AbstractChannelHandlerContext.java:1129)
	at io.netty.channel.AbstractChannelHandlerContext$AbstractWriteTask.run(AbstractChannelHandlerContext.java:1070)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 16:32:12.120 - [mp-conn-work-3-6] ERROR - com.mpush.common.MessageDispatcher - dispatch message ex, packet=JsonPacket{cmd=19, cc=0, flags=16, sessionId=27, lrc=0, body={"fromUserId":"25","toUserType":"1","fromUserType":"2","userId":36,"content":"3333","token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJhdXRoMCIsImV4cCI6MTY2NzQ2MjAxNCwiaWF0IjoxNjY2ODU3MjE0LCJ1c2VySWQiOiIyNSJ9.yljeek0TcGeeRbnc3eQKE7SO9S5CutBBSyjQc11bg74"}}, connect=[channel=[id: 0xe114cfbc, L:/10.200.5.34:8888 - R:/10.200.5.49:62521], context=, status=1, lastReadTime=1666859527895, lastWriteTime=0], body=null
java.lang.ClassCastException: java.lang.Integer cannot be cast to java.lang.String
	at com.mpush.core.handler.UserChatHandler.decode(UserChatHandler.java:64)
	at com.mpush.core.handler.UserChatHandler.decode(UserChatHandler.java:47)
	at com.mpush.common.handler.BaseMessageHandler.handle(BaseMessageHandler.java:44)
	at com.mpush.common.MessageDispatcher.onReceive(MessageDispatcher.java:86)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:42)
	at com.mpush.core.server.WebSocketChannelHandler.channelRead0(WebSocketChannelHandler.java:24)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:105)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)
	at io.netty.handler.codec.http.websocketx.Utf8FrameValidator.channelRead(Utf8FrameValidator.java:77)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler$1.channelRead(WebSocketServerProtocolHandler.java:204)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:647)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:582)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:499)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:461)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 16:32:55.036 - [mp-conn-work-3-8] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@7e7c3de
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 16:32:58.878 - [mp-conn-work-3-8] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@222f00ea
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 17:54:12.410 - [mp-conn-work-3-4] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@22b65d84
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 18:10:06.221 - [mp-conn-work-3-5] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@6256f5ef
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 18:42:33.170 - [mp-conn-work-3-2] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@baefb2c
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
2022-10-27 18:44:00.715 - [mp-conn-work-3-2] WARN  - i.n.u.c.AbstractEventExecutor - A task raised an exception. Task: com.mpush.core.push.SingleUserPushTask@a525544
java.lang.ClassCastException: com.mpush.common.message.ChatMessage cannot be cast to com.mpush.common.message.gateway.GatewayPushMessage
	at com.mpush.core.push.GatewayPushListener.onOffline(GatewayPushListener.java:43)
	at com.mpush.core.push.SingleUserPushTask.checkRemote(SingleUserPushTask.java:176)
	at com.mpush.core.push.SingleUserPushTask.run(SingleUserPushTask.java:92)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute$$$capture(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:465)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
